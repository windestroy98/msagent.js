<object id="AgentControl" width="0" height="0"
  classid="CLSID:D45FD31B-5C6E-11D1-9EC1-00C04FD7081F"
  codebase="#VERSION=2,0,0,0">
</object>

<object id="L&HTruVoice" width="0" height="0"
  classid="CLSID:B8F2846E-CE36-11D0-AC83-00C04FD97575"
  codebase="#VERSION=6,0,0,0">
</object>

<script language="JavaScript" type="text/javascript" type="text/javascript">
<!--//
/*
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
'_/ Portions generated by MASH - Microsoft Agent Scripting Helper, version 7.5
'_/ by BellCraft Technologies, http://www.bellcraft.com/mash
'_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
*/

// * Character Objects
var Merlin;

// * Variables
var UsedChars;
var MerlinID;
var MerlinACS;
var MerlinLoaded;
var LoadReq;
var HideReq;

// * Initialize
UsedChars = "Merlin";

// * Merlin
MerlinID = "Merlin";
MerlinACS = "merlin.acs";
MerlinLoaded = false;


Window_OnLoad();

function Window_OnLoad() {
    // Purpose:  Runs automatically when page is loaded

    // * INSERT ANY NON-AGENT RELATED SCRIPTING HERE

    AgentControl.Connected = true;

    MerlinLoaded = LoadLocalChar(MerlinID, MerlinACS);

    if (!MerlinLoaded) {
        // Attempt to load default character
        MerlinLoaded = LoadLocalChar(MerlinID, "");
    }

    if (MerlinLoaded) {
        SetCharObj();
    }
    CheckLoadStatus();
}

function LoadLocalChar(CharID, CharACS) {
    // Purpose:  Attempts to load the specified character
    // Returns:  true if successful, false if not

    AgentControl.RaiseRequestErrors = false;
    if (CharACS == "") {

        LoadReq = AgentControl.Characters.Load(CharID);
    }
    else {
        LoadReq = AgentControl.Characters.Load(CharID, CharACS);
    }
    AgentControl.RaiseRequestErrors = true;

    if (LoadReq.Status != 1) {
        return(true);
    }
    return(false);
}

function SetCharObj() {
    // Purpose:  Sets the character reference and TTS Language ID

    Merlin = AgentControl.Characters.Character(MerlinID);
    Merlin.LanguageID = 0x409;
}

function CheckLoadStatus() {
    // Purpose:  Determines if required characters have been loaded.
    //           If not, issue request to load next character
    //           else run the AgentIntro routine

    if (!MerlinLoaded) {
        LoadError();
        return(false);
    }

    window.status = "";
    AgentIntro();
    return(true);
}

function LoadError() {
    var strMsg;
    window.status = "";
    strMsg = "Error Loading Character: " + MerlinID + "\n";
    strMsg = strMsg + "This Microsoft Agent Script requires the character(s):\n";
    strMsg = strMsg + UsedChars;
    alert(strMsg);
}
function InitAgentCommands() {
    // Purpose:  Initialize the Commands menu

    Merlin.Commands.RemoveAll();
    Merlin.Commands.Caption = "MASH Menu";
    Merlin.Commands.Add("ACO", "Advanced Character Options", "Advanced Character Options");
}

function AgentIntro() {
    InitAgentCommands();

    // *** BEGIN MASH USER SCRIPT ***

    Merlin.Show();
    Merlin.Play("Greet");
    Merlin.Speak("Greetings, i' m merlin");
    Merlin.Play("RestPose");
    Merlin.Play("Explain");
    Merlin.Speak("So, Welcome to MSAgent.js");
    
    Merlin.Speak("Microsoft Agent was abandoned from The Late 2000's, And the Early 2010's");
    Merlin.Play("RestPose");
    Merlin.Play("Sad");
    Merlin.Speak("Unfortunately, Microsoft did not release any updates since version 2.0");
    Merlin.Speak("And no major companies uses it anymore");
    Merlin.Play("Congratulate_2");
    Merlin.Speak("Fortunately , some small communities are making programs with it");
    Merlin.Play("RestPose");
    Merlin.Speak("And some pepole are making videos with it");
    Merlin.Play("Wave");
    Merlin.Speak("Thanks for your time, i got to go!");
    Merlin.Speak("Bye!");
    Merlin.Hide();


    // *** END MASH USER SCRIPT ***
}
//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="RequestComplete(RequestObject)">
<!--//
    // Purpose:  Take action on completion or failure of requests

//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="Command(UserInput)">
<!--//
    // Purpose:  Determine Command that was selected either by menu or voice
    //           and run the applicable Command Script
    var BadConfidence;
    BadConfidence = 10;

    if (UserInput.Confidence <= -40)
    {
        // Bad Recognition
    }
    else if ((UserInput.Alt1Name != "") && (Math.abs(Math.abs(UserInput.Alt1Confidence) - Math.abs(UserInput.Confidence)) < BadConfidence))
    {
        // Bad Confidence - too close to another command
    }
    else if ((UserInput.Alt2Name != "") && (Math.abs(Math.abs(UserInput.Alt1Confidence) - Math.abs(UserInput.Confidence)) < BadConfidence))
    {
        // Bad Confidence - too close to another command
    }
    else
    {
        // High Confidence
        // *** BEGIN MASH USER COMMANDS ***
        switch(UserInput.Name) {
        case "ACO" :
            AgentControl.PropertySheet.Visible = true;
            break;
        }
        // *** END MASH USER COMMANDS ***
    }
//-->
</script>


<script language="JavaScript" type="text/javascript" for="AgentControl" event="Bookmark(BookmarkID)">
<!--//
//-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="Click(CharacterID, Button, Shift, X, Y)">
<!--
    // Insert Click Event Code Here
-->
</script>

<script language="JavaScript" type="text/javascript" for="AgentControl" event="DblClick(CharacterID, Button, Shift, X, Y)">
<!--
    // Purpose:  Stop and Hide all characters on double-click

    Merlin.StopAll();
    if (!Merlin.HasOtherClients) {
        if (Merlin.Visible) {
            HideReq = Merlin.Hide();
        }
        else {
            AgentControl.Characters.Character.Unload(MerlinID);
        }
    }
//_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
//-->
</script>

